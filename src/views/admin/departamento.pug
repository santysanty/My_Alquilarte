.card.shadow.mb-4
  .card-header.bg-success.text-white.d-flex.justify-content-between.align-items-center
    span.fw-bold.ms-2
      i.fas.fa-building.me-1
      | Departamento
    span#departmentCounter.badge.bg-light.text-success
      - var initialCount = (typeof departamentos !== 'undefined' && departamentos !== null && departamentos.length) ? departamentos.length : 0
      | #{initialCount} registrados

  .card-body
    .d-flex.justify-content-between.align-items-center.mb-3
      .input-group.me-3
        input.form-control#searchDepartments(type="text", placeholder="Buscar departamento...")
        button.btn.btn-outline-secondary(type="button")
          i.fas.fa-search

      button#addDepartmentBtn.btn.btn-success
        i.fas.fa-plus.me-1
        | Agregar

    // IMPORTANTE: Se quitó la clase 'collapse' y se añadió 'style="display: none;"'
    // para que el formulario sea manejado por JavaScript directamente, sin depender de Bootstrap JS.
    #departmentFormCollapse(style="display: none;")
      .card.mb-4
        .card-body
          form#departmentForm
            input(type="hidden", id="departmentId")
            .mb-3
              label.form-label(for="departmentName") Nombre
              input.form-control(type="text", id="departmentName", name="name", required)
            .mb-3
              label.form-label(for="departmentDescription") Descripción
              textarea.form-control(id="departmentDescription", name="description")
            .mb-3.form-check
              input.form-check-input(type="checkbox", id="departmentActive", name="isActive")
              label.form-check-label(for="departmentActive") Activo
            .d-flex.justify-content-start.mt-3
              button.btn.btn-success(type="submit")
                i.fas.fa-save.me-1
                | Guardar
              button#cancelDepartmentEdit.btn.btn-secondary.ms-2(type="button")
                i.fas.fa-times.me-1
                | Cancelar

    hr

    table.table.table-hover.table-bordered.mt-4
      thead.table-success
        tr
          th ID
          th Nombre
          th Descripción
          th Activo
          th Acciones
      tbody#departmentsTableBody
        tr
          td(colspan="5").text-center.text-muted Cargando departamentos...
